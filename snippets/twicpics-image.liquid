{%- liquid
  assign class = class | default: ''
  assign eager = eager | default: false
  assign focus = focus | default: 'auto'
  assign transform = transform | default: ''
  assign image_url = image
  assign image_url = image_url | image_url | split: '?' | first
  assign preview = preview | default: false

  if image_url contains '//playlovetoys.ca'
    assign image_url = image_url | replace: '//playlovetoys.ca', ''
  elsif image_url contains '//cdn.shopify.com'
    assign image_url = image_url | replace: '//cdn.shopify.com/s/files/1/0603/8198/6891/', '/cdn/shop/'
  endif
-%}
{% if preview %}
  <figure
    class="twic-image-wrapper"
    data-twic-background="url(https://playlovetoys.twic.pics{{ image_url }}?twic=v1/output=preview)"
  >
{% endif %}
<img
  data-twic-src="image:{{ image_url }}"
  {% if class != '' %}
    class="{{ class }}"
  {% endif -%}
  {% if eager == true %}
    data-twic-eager
  {% endif -%}
  {% if focus != '' %}
    data-twic-focus="{{ focus }}"
  {% endif -%}
  {% if transform != '' %}
    data-twic-transform="{{ transform }}"
  {% endif %}
  data-twic-bot="contain=300x300/quality-max=50"
  data-twic-step="25"
>
{% if preview %}
  </figure>
{% endif %}
