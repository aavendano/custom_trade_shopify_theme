{{ 'section-image-banner.css' | asset_url | stylesheet_tag }}
{{ 'component-slider.css' | asset_url | stylesheet_tag }}
{{ 'component-slideshow.css' | asset_url | stylesheet_tag }}

{% liquid
  assign block_dom_id = 'slide-block-' | append: block.id
  assign overlay_percent = block.settings.image_overlay_opacity | default: 0
  assign overlay_opacity = overlay_percent | times: 0.01
  assign gradient_direction = 'to top'
  if block.settings.gradient_direction == 'top_to_bottom'
    assign gradient_direction = 'to bottom'
  endif
  assign gradient_start = block.settings.gradient_start_distance | default: 50
  assign alt_text = block.settings.cloudinary_alt
  if alt_text == blank
    if block.settings.image != blank and block.settings.image.alt != blank
      assign alt_text = block.settings.image.alt
    elsif block.settings.heading != blank
      assign alt_text = block.settings.heading | strip_html
    else
      assign alt_text = shop.name
    endif
  endif
%}

{% style %}
  {{ block.settings.heading_font | font_face }}
  {{ block.settings.subheading_font | font_face }}

  ##{{ block_dom_id }}.slide-block {
    position: relative;
  }

  ##{{ block_dom_id }} .slide-block__media {
    position: relative;
  }

  ##{{ block_dom_id }} .slide-block__media-inner {
    position: relative;
    width: 100%;
    height: 100%;
  }

  ##{{ block_dom_id }} .slide-block__media-inner > * {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  ##{{ block_dom_id }} .slide-block__overlay {
    position: absolute;
    inset: 0;
    pointer-events: none;
    {% if block.settings.gradient_overlay_enabled %}
      background: linear-gradient({{ gradient_direction }}, {{ block.settings.gradient_color }} {{ gradient_start }}%, transparent 100%);
      opacity: 1;
    {% elsif overlay_percent > 0 %}
      background-color: rgba(0, 0, 0, {{ overlay_opacity }});
    {% else %}
      display: none;
    {% endif %}
  }

  ##{{ block_dom_id }} .slide-block__heading {
    {% if block.settings.heading_color != blank %}
      color: {{ block.settings.heading_color }};
    {% endif %}
    {% if block.settings.heading_font_size_mobile %}
      font-size: {{ block.settings.heading_font_size_mobile }}px;
    {% endif %}
    {% if block.settings.heading_font != blank %}
      font-family: {{ block.settings.heading_font.family }}, {{ block.settings.heading_font.fallback_families }};
      font-weight: {{ block.settings.heading_font.weight }};
      font-style: {{ block.settings.heading_font.style }};
    {% endif %}
    {% if block.settings.heading_shadow_enabled %}
      text-shadow: {{ block.settings.heading_shadow_x }}px {{ block.settings.heading_shadow_y }}px {{ block.settings.heading_shadow_blur }}px {{ block.settings.heading_shadow_color }};
    {% endif %}
  }

  ##{{ block_dom_id }} .slide-block__subheading {
    {% if block.settings.subheading_color != blank %}
      color: {{ block.settings.subheading_color }};
    {% endif %}
    {% if block.settings.subheading_font_size_mobile %}
      font-size: {{ block.settings.subheading_font_size_mobile }}px;
    {% endif %}
    {% if block.settings.subheading_font != blank %}
      font-family: {{ block.settings.subheading_font.family }}, {{ block.settings.subheading_font.fallback_families }};
      font-weight: {{ block.settings.subheading_font.weight }};
      font-style: {{ block.settings.subheading_font.style }};
    {% endif %}
    {% if block.settings.subheading_shadow_enabled %}
      text-shadow: {{ block.settings.subheading_shadow_x }}px {{ block.settings.subheading_shadow_y }}px {{ block.settings.subheading_shadow_blur }}px {{ block.settings.subheading_shadow_color }};
    {% endif %}
  }

  ##{{ block_dom_id }} .slide-block__buttons .button {
    {% if block.settings.button_text_color != blank %}
      color: {{ block.settings.button_text_color }};
    {% endif %}
    {% if block.settings.button_background_color != blank %}
      background-color: {{ block.settings.button_background_color }};
      border-color: {{ block.settings.button_background_color }};
    {% endif %}
  }

  @media screen and (min-width: 750px) {
    ##{{ block_dom_id }} .slide-block__heading {
      {% if block.settings.heading_font_size %}
        font-size: {{ block.settings.heading_font_size }}px;
      {% endif %}
    }

    ##{{ block_dom_id }} .slide-block__subheading {
      {% if block.settings.subheading_font_size %}
        font-size: {{ block.settings.subheading_font_size }}px;
      {% endif %}
    }
  }
{% endstyle %}

<div id="{{ block_dom_id }}" class="slide-block banner banner--adapt-image" {{ block.shopify_attributes }}>
  <div class="slide-block__media banner__media media{% if block.settings.image == blank and block.settings.cloudinary_public_id == blank and block.settings.cloudinary_id == blank %} placeholder{% endif %}">
    <div class="slide-block__media-inner">
      {%- if block.settings.cloudinary_public_id != blank -%}
        <img
          src="https://res.cloudinary.com/dv0xafomh/image/upload/f_auto,q_auto/{{ block.settings.cloudinary_public_id | replace: ' ', '%20' }}"
          alt="{{ alt_text | escape }}"
          class="slide-block__image"
          loading="lazy"
        >
      {%- elsif block.settings.cloudinary_id != blank -%}
        <img
          src="{{ block.settings.cloudinary_id }}"
          alt="{{ alt_text | escape }}"
          class="slide-block__image"
          loading="lazy"
        >
      {%- elsif block.settings.image != blank -%}
        {%- if block.settings.serve_from_twicpics -%}
          {% render 'twic-picture',
            image: block.settings.image,
            focus: 'auto',
            eager: false,
            alt: alt_text,
            class: 'slide-block__image'
          %}
        {%- else -%}
          {{
            block.settings.image
            | image_url: width: 3840
            | image_tag:
              loading: 'lazy',
              class: 'slide-block__image',
              sizes: '100vw',
              widths: '375, 550, 750, 1100, 1500, 1780, 2000, 3000, 3840',
              alt: alt_text
          }}
        {%- endif -%}
      {%- else -%}
        {{ 'hero-apparel-1' | placeholder_svg_tag: 'placeholder-svg' }}
      {%- endif -%}
    </div>
    <div class="slide-block__overlay"></div>
  </div>

  <div class="slide-block__content banner__content banner__content--{{ block.settings.box_align }} page-width{% if block.settings.show_text_box == false %} banner--desktop-transparent{% endif %}">
    <div class="slide-block__text banner__box content-container content-container--full-width-mobile color-{{ block.settings.color_scheme }} gradient slideshow__text--{{ block.settings.text_alignment }} slideshow__text-mobile--{{ block.settings.text_alignment_mobile }}">
      {%- if block.settings.heading != blank -%}
        <h2 class="slide-block__heading banner__heading inline-richtext {{ block.settings.heading_size }}">
          {{ block.settings.heading }}
        </h2>
      {%- endif -%}
      {%- if block.settings.subheading != blank -%}
        <div class="slide-block__subheading banner__text rte">
          <p>{{ block.settings.subheading }}</p>
        </div>
      {%- endif -%}
      {%- if block.settings.button_label != blank -%}
        <div class="slide-block__buttons banner__buttons">
          <a
            {% if block.settings.link != blank %}
              href="{{ block.settings.link }}"
            {% else %}
              role="link"
              aria-disabled="true"
            {% endif %}
            class="button {% if block.settings.button_style_secondary %}button--secondary{% else %}button--primary{% endif %}"
          >
            {{- block.settings.button_label | escape -}}
          </a>
        </div>
      {%- endif -%}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Slideshow slide",
  "settings": [
    {
      "type": "text",
      "id": "cloudinary_id",
      "label": "Cloudinary Image ID",
      "info": "Enter the public ID of your Cloudinary image (e.g., 'sample.jpg'). Takes priority over Shopify image."
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "t:sections.slideshow.blocks.slide.settings.image.label"
    },
    {
      "type": "checkbox",
      "id": "serve_from_twicpics",
      "label": "Serve from Twicpics",
      "default": true,
      "info": "If enabled, the image will be optimized and served via Twicpics"
    },
    {
      "type": "header",
      "content": "Cloudinary Image (Alternative)"
    },
    {
      "type": "text",
      "id": "cloudinary_public_id",
      "label": "Cloudinary Public ID",
      "info": "Use this instead of Shopify image for Cloudinary optimization"
    },
    {
      "type": "text",
      "id": "cloudinary_alt",
      "label": "Cloudinary Image Alt Text"
    },
    {
      "type": "range",
      "id": "image_overlay_opacity",
      "min": 0,
      "max": 100,
      "step": 10,
      "unit": "%",
      "label": "t:sections.slideshow.blocks.slide.settings.image_overlay_opacity.label",
      "default": 0
    },
    {
      "type": "header",
      "content": "Gradient Overlay"
    },
    {
      "type": "checkbox",
      "id": "gradient_overlay_enabled",
      "label": "Enable gradient overlay",
      "default": false
    },
    {
      "type": "color",
      "id": "gradient_color",
      "label": "Gradient color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "gradient_start_distance",
      "min": 0,
      "max": 80,
      "step": 5,
      "unit": "%",
      "label": "Distance to start gradient",
      "default": 50
    },
    {
      "type": "select",
      "id": "gradient_direction",
      "options": [
        {
          "value": "bottom_to_top",
          "label": "Bottom to top"
        },
        {
          "value": "top_to_bottom",
          "label": "Top to bottom"
        }
      ],
      "default": "bottom_to_top",
      "label": "Gradient direction"
    },
    {
      "type": "header",
      "content": "t:sections.slideshow.blocks.slide.settings.header_text.content"
    },
    {
      "type": "header",
      "content": "Heading Styles"
    },
    {
      "type": "font_picker",
      "id": "heading_font",
      "label": "Font",
      "default": "assistant_n4"
    },
    {
      "type": "range",
      "id": "heading_font_size",
      "min": 16,
      "max": 120,
      "step": 2,
      "unit": "px",
      "label": "Font size (Desktop)",
      "default": 50
    },
    {
      "type": "range",
      "id": "heading_font_size_mobile",
      "min": 16,
      "max": 80,
      "step": 2,
      "unit": "px",
      "label": "Font size (Mobile)",
      "default": 30
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Color"
    },
    {
      "type": "checkbox",
      "id": "heading_shadow_enabled",
      "label": "Enable text shadow",
      "default": false
    },
    {
      "type": "color",
      "id": "heading_shadow_color",
      "label": "Shadow color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "heading_shadow_blur",
      "min": 0,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Shadow blur",
      "default": 2
    },
    {
      "type": "range",
      "id": "heading_shadow_x",
      "min": -10,
      "max": 10,
      "step": 1,
      "unit": "px",
      "label": "Shadow X offset",
      "default": 2
    },
    {
      "type": "range",
      "id": "heading_shadow_y",
      "min": -10,
      "max": 10,
      "step": 1,
      "unit": "px",
      "label": "Shadow Y offset",
      "default": 2
    },
    {
      "type": "select",
      "id": "heading_size",
      "options": [
        {
          "value": "h1",
          "label": "t:sections.all.heading_size.options__1.label"
        },
        {
          "value": "h2",
          "label": "t:sections.all.heading_size.options__2.label"
        },
        {
          "value": "h3",
          "label": "t:sections.all.heading_size.options__3.label"
        },
        {
          "value": "h4",
          "label": "t:sections.all.heading_size.options__4.label"
        },
        {
          "value": "h5",
          "label": "t:sections.all.heading_size.options__5.label"
        }
      ],
      "default": "h2",
      "label": "t:sections.all.heading_size.label"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "t:sections.slideshow.blocks.slide.settings.heading.label",
      "default": "t:sections.slideshow.blocks.slide.settings.heading.default"
    },
    {
      "type": "header",
      "content": "Subheading Styles"
    },
    {
      "type": "font_picker",
      "id": "subheading_font",
      "label": "Font",
      "default": "assistant_n4"
    },
    {
      "type": "range",
      "id": "subheading_font_size",
      "min": 12,
      "max": 60,
      "step": 2,
      "unit": "px",
      "label": "Font size (Desktop)",
      "default": 18
    },
    {
      "type": "range",
      "id": "subheading_font_size_mobile",
      "min": 12,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Font size (Mobile)",
      "default": 16
    },
    {
      "type": "color",
      "id": "subheading_color",
      "label": "Color"
    },
    {
      "type": "checkbox",
      "id": "subheading_shadow_enabled",
      "label": "Enable text shadow",
      "default": false
    },
    {
      "type": "color",
      "id": "subheading_shadow_color",
      "label": "Shadow color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "subheading_shadow_blur",
      "min": 0,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Shadow blur",
      "default": 2
    },
    {
      "type": "range",
      "id": "subheading_shadow_x",
      "min": -10,
      "max": 10,
      "step": 1,
      "unit": "px",
      "label": "Shadow X offset",
      "default": 2
    },
    {
      "type": "range",
      "id": "subheading_shadow_y",
      "min": -10,
      "max": 10,
      "step": 1,
      "unit": "px",
      "label": "Shadow Y offset",
      "default": 2
    },
    {
      "type": "textarea",
      "id": "subheading",
      "label": "t:sections.slideshow.blocks.slide.settings.subheading.label",
      "default": "t:sections.slideshow.blocks.slide.settings.subheading.default"
    },
    {
      "type": "header",
      "content": "Button Styles"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Text color"
    },
    {
      "type": "color",
      "id": "button_background_color",
      "label": "Background color"
    },
    {
      "type": "header",
      "content": "t:sections.slideshow.blocks.slide.settings.header_button.content"
    },
    {
      "type": "text",
      "id": "button_label",
      "default": "t:sections.slideshow.blocks.slide.settings.button_label.default",
      "label": "t:sections.slideshow.blocks.slide.settings.button_label.label",
      "info": "t:sections.slideshow.blocks.slide.settings.button_label.info"
    },
    {
      "type": "url",
      "id": "link",
      "label": "t:sections.slideshow.blocks.slide.settings.link.label"
    },
    {
      "type": "checkbox",
      "id": "button_style_secondary",
      "label": "t:sections.slideshow.blocks.slide.settings.secondary_style.label",
      "default": false
    },
    {
      "type": "header",
      "content": "t:sections.slideshow.blocks.slide.settings.header_layout.content"
    },
    {
      "type": "checkbox",
      "id": "show_text_box",
      "label": "t:sections.slideshow.blocks.slide.settings.show_text_box.label",
      "default": true
    },
    {
      "type": "select",
      "id": "box_align",
      "options": [
        {
          "value": "top-left",
          "label": "t:sections.slideshow.blocks.slide.settings.box_align.options__1.label"
        },
        {
          "value": "top-center",
          "label": "t:sections.slideshow.blocks.slide.settings.box_align.options__2.label"
        },
        {
          "value": "top-right",
          "label": "t:sections.slideshow.blocks.slide.settings.box_align.options__3.label"
        },
        {
          "value": "middle-left",
          "label": "t:sections.slideshow.blocks.slide.settings.box_align.options__4.label"
        },
        {
          "value": "middle-center",
          "label": "t:sections.slideshow.blocks.slide.settings.box_align.options__5.label"
        },
        {
          "value": "middle-right",
          "label": "t:sections.slideshow.blocks.slide.settings.box_align.options__6.label"
        },
        {
          "value": "bottom-left",
          "label": "t:sections.slideshow.blocks.slide.settings.box_align.options__7.label"
        },
        {
          "value": "bottom-center",
          "label": "t:sections.slideshow.blocks.slide.settings.box_align.options__8.label"
        },
        {
          "value": "bottom-right",
          "label": "t:sections.slideshow.blocks.slide.settings.box_align.options__9.label"
        }
      ],
      "default": "middle-center",
      "label": "t:sections.slideshow.blocks.slide.settings.box_align.label"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "options": [
        {
          "value": "left",
          "label": "t:sections.slideshow.blocks.slide.settings.text_alignment.option_1.label"
        },
        {
          "value": "center",
          "label": "t:sections.slideshow.blocks.slide.settings.text_alignment.option_2.label"
        },
        {
          "value": "right",
          "label": "t:sections.slideshow.blocks.slide.settings.text_alignment.option_3.label"
        }
      ],
      "default": "center",
      "label": "t:sections.slideshow.blocks.slide.settings.text_alignment.label"
    },
    {
      "type": "select",
      "id": "text_alignment_mobile",
      "options": [
        {
          "value": "left",
          "label": "t:sections.slideshow.blocks.slide.settings.text_alignment_mobile.options__1.label"
        },
        {
          "value": "center",
          "label": "t:sections.slideshow.blocks.slide.settings.text_alignment_mobile.options__2.label"
        },
        {
          "value": "right",
          "label": "t:sections.slideshow.blocks.slide.settings.text_alignment_mobile.options__3.label"
        }
      ],
      "default": "center",
      "label": "t:sections.slideshow.blocks.slide.settings.text_alignment_mobile.label"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "scheme-1"
    }
  ],
  "presets": [
    {
      "name": "Slideshow slide"
    }
  ]
}
{% endschema %}
