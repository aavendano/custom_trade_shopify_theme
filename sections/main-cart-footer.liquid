<div class="b-box">
  <!-- Cart note (si está habilitado) -->
  {% if settings.show_cart_note %}
    <div class="b-mb-5">
      <label for="Cart-note" class="b-label b-mb-2">
        {{ 'sections.cart.note' | t }}
      </label>
      <textarea
        class="b-textarea"
        name="note"
        form="cart"
        id="Cart-note"
        placeholder="{{ 'sections.cart.note' | t }}"
      >{{ cart.note }}</textarea>
    </div>
  {% endif %}

  <!-- Discounts (si existen) -->
  {% if cart.cart_level_discount_applications.size > 0 %}
    <div class="b-mb-5">
      <h3 class="b-is-size-6 b-has-text-weight-semibold b-mb-2">Discounts</h3>

      <ul class="b-pl-4">
        {% for discount in cart.cart_level_discount_applications %}
          <li class="b-is-flex b-is-align-items-center b-mb-1">
            {{ 'icon-discount.svg' | inline_asset_content }}
            <span class="b-ml-2"> {{ discount.title }} (−{{ discount.total_allocated_amount | money }}) </span>
          </li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}

  <!-- Totals Card -->
  <div class="b-box b-p-4 b-mb-5">
    <!-- Línea horizontal estilo ecuación -->
    <div class="b-is-flex b-is-align-items-center b-is-justify-content-space-between">
      <span class="b-is-size-5 b-has-text-weight-semibold">
        {{ 'sections.cart.estimated_total' | t }}
      </span>

      <strong class="b-is-size-4">
        {{ cart.total_price | money_with_currency }}
      </strong>
    </div>

    <!-- Tax + Duties -->
    <p class="b-is-size-7 b-has-text-grey b-mt-2">
      {% if cart.duties_included and cart.taxes_included %}
        {% if shop.shipping_policy.body == blank %}
          {{ 'sections.cart.duties_and_taxes_included_shipping_at_checkout_without_policy' | t }}
        {% else %}
          {{
            'sections.cart.duties_and_taxes_included_shipping_at_checkout_with_policy_html'
            | t: link: shop.shipping_policy.url
          }}
        {% endif %}
      {% elsif cart.duties_included == false and cart.taxes_included %}
        {% if shop.shipping_policy.body == blank %}
          {{ 'sections.cart.taxes_included_shipping_at_checkout_without_policy' | t }}
        {% else %}
          {{ 'sections.cart.taxes_included_shipping_at_checkout_with_policy_html' | t: link: shop.shipping_policy.url }}
        {% endif %}
      {% elsif cart.duties_included and cart.taxes_included == false %}
        {% if shop.shipping_policy.body == blank %}
          {{ 'sections.cart.duties_included_taxes_at_checkout_shipping_at_checkout_without_policy' | t }}
        {% else %}
          {{
            'sections.cart.duties_included_taxes_at_checkout_shipping_at_checkout_with_policy_html'
            | t: link: shop.shipping_policy.url
          }}
        {% endif %}
      {% else %}
        {% if shop.shipping_policy.body == blank %}
          {{ 'sections.cart.taxes_at_checkout_shipping_at_checkout_without_policy' | t }}
        {% else %}
          {{
            'sections.cart.taxes_at_checkout_shipping_at_checkout_with_policy_html'
            | t: link: shop.shipping_policy.url
          }}
        {% endif %}
      {% endif %}
    </p>
  </div>

  <!-- Checkout Buttons -->
  <div class="b-mt-4">
    <button
      type="submit"
      id="checkout"
      class="b-button b-is-primary b-is-fullwidth b-is-medium"
      name="checkout"
      form="cart"
      @click="$ajax('/cart/checkout', {method: 'POST'})"
      {% if cart == empty %}
        disabled
      {% endif %}
    >
      {{ 'sections.cart.checkout' | t }}
    </button>

    {% if additional_checkout_buttons %}
      <div class="b-mt-3">
        {{ content_for_additional_checkout_buttons }}
      </div>
    {% endif %}
  </div>
</div>

{% schema %}
{
  "name": "t:sections.main-cart-footer.name",
  "class": "cart__footer-wrapper",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 40
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 40
    }
  ],
  "blocks": [
    {
      "type": "subtotal",
      "name": "t:sections.main-cart-footer.blocks.subtotal.name",
      "limit": 1
    },
    {
      "type": "buttons",
      "name": "t:sections.main-cart-footer.blocks.buttons.name",
      "limit": 1
    },
    {
      "type": "@app"
    }
  ]
}
{% endschema %}
